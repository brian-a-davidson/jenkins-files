#!/usr/bin/env groovy

pipeline {
   
  agent {
    docker {
      reuseNode true
      image 'nonanom/release-tools:latest'
    }
  }

  environment {
    VAULT_ADDR="https://20.14.84.68:8200"
    VAULT_MBO_PATH="projects/hazelcast"
    VAULT_APP_PATH="projects/hazelcast/version"
    VAULT_SKIP_VERIFY="true"
    ROLE_ID=credentials('vault2-role-id')
    SECRET_ID=credentials('vault2-secret-id')
    APP_VERSION="${params.VERSION}"
    APP_NAME="springbootadmin"
    NAMESPACE="default"
    IMAGE="image=azure_registry.azurecr.io/test/springbootadmin:${APP_VERSION}"
    TIMEOUT_VALUE="5m"
  }

  stages {
	  
	 stage('Login') {
      steps {
        sh '''
	
	vault login hvs.CAESIHF5gocawCz-32PO4rqJbl8aq1WTjgzwgrJxrQbc17WnGh4KHGh2cy55eEJlNFRBc1MxcXEyc29oUTRQYVlDaFg
        '''
      		}
	}
  }

  post {
    cleanup {
      deleteDir()
    }
  }
}
